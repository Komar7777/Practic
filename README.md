## Описание проекта

Данный проект представляет собой веб-приложение, разработанное в рамках **выпускной квалификационной работы (ВКР)** на тему _Прогнозирование неисправности компьютерных компонентов методами машинного обучения_. **Автор**: Комаров Даниил Иванович.

Приложение предназначено для:
- Анализа данных о состоянии компьютерных компонентов.
- Обучения моделей машинного обучения для прогнозирования неисправностей.
- Визуализации результатов анализа и производительности моделей.
- Генерации отчетов в формате PDF.
- Выполнения предсказаний на основе введенных данных.

Проект использует датасет `POLOMKA.csv` или синтетические данные, реализует множество алгоритмов машинного обучения и предоставляет пользователю интерактивный интерфейс через библиотеку *Streamlit*.

## Основные возможности

- **Загрузка данных**: Поддержка загрузки датасета из локального файла или по URL с обработкой различных кодировок.
- **Генерация синтетических данных**: Создание тестовых данных для отладки и стресс-тестирования.
- **Предобработка данных**: Кодирование категориальных переменных, нормализация, удаление выбросов.
- **Анализ данных**: Визуализация корреляций, распределений признаков, box plots, матрицы рассеяния и 3D-графиков.
- **Обучение моделей**: Реализованы алгоритмы:
  - Random Forest
  - Gradient Boosting
  - Многослойный перцептрон (MLP)
  - Метод опорных векторов (SVM)
  - K ближайших соседей (KNN)
  - Ансамблевая модель стэкинга
- **Подбор гиперпараметров**: Автоматический подбор гиперпараметров с помощью `GridSearchCV`.
- **Подбор признаков**: Использование алгоритма Boruta для выбора значимых признаков.
- **Оценка моделей**: Расчет метрик (Accuracy, Precision, Recall, F1, Log Loss, ROC-AUC), построение матриц ошибок и ROC-кривых.
- **Интерпретация моделей**: Анализ SHAP-значений для понимания влияния признаков.
- **Кросс-валидация**: Проверка устойчивости моделей на разных фолдах.
- **Стресс-тестирование**: Тестирование моделей на больших синтетических наборах данных.
- **Тестирование подмножеств признаков**: Оценка производительности моделей на различных комбинациях признаков.
- **Анализ гиперпараметров**: Исследование чувствительности моделей к изменению гиперпараметров.
- **Генерация отчетов**: Создание PDF-отчетов с результатами.
- **Юнит-тестирование**: Автоматизированные тесты для проверки функциональности.

## Требования

Для работы приложения необходимо установить зависимости, указанные в файле `requirements.txt`:

```
altair==5.5.0
attrs==25.3.0
blinker==1.9.0
Boruta==0.4.3
cachetools==5.5.2
certifi==2025.6.15
chardet==5.2.0
charset-normalizer==3.4.2
click==8.2.1
cloudpickle==3.1.1
colorama==0.4.6
contourpy==1.3.2
cycler==0.12.1
fonttools==4.57.0
gitdb==4.0.12
GitPython==3.1.44
idna==3.10
Jinja2==3.1.6
joblib==1.5.0
jsonschema==4.24.0
jsonschema-specifications==2025.4.1
kiwisolver==1.4.8
llvmlite==0.44.0
MarkupSafe==3.0.2
matplotlib==3.10.1
narwhals==1.43.0
numba==0.61.2
numpy==2.2.5
packaging==24.2
pandas==2.2.3
pillow==11.2.1
protobuf==6.31.1
pyarrow==20.0.0
pydeck==0.9.1
pyparsing==3.2.3
python-dateutil==2.9.0.post0
pytz==2025.2
referencing==0.36.2
reportlab==4.4.1
requests==2.32.4
rpds-py==0.25.1
scikit-learn==1.6.1
scipy==1.15.2
seaborn==0.13.2
shap==0.47.2
six==1.17.0
slicer==0.0.8
smmap==5.0.2
streamlit==1.45.1
tenacity==9.1.2
threadpoolctl==3.6.0
toml==0.10.2
tornado==6.5.1
tqdm==4.67.1
typing_extensions==4.13.2
tzdata==2025.2
urllib3==2.4.0
watchdog==6.0.0
```

### Установка

1. Убедитесь, что установлен Python версии 3.6 или выше.
2. Создайте виртуальное окружение:
   ```
   python -m venv venv
   ```
3. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

## Использование

1. Запустите приложение:
   ```
   streamlit run main.py
   ```
2. Откройте веб-браузер и перейдите по адресу, указанному в терминале (обычно `http://localhost:8501`).
3. В интерфейсе выберите действие через боковую панель:
   - Загрузите датасет или используйте синтетические данные.
   - Выполните анализ данных, обучение моделей, предсказания или генерацию отчетов.
   - Проверьте окружение или запустите юнит-тесты через раздел *Диагностика*.

## Структура проекта

- `main.py`: Основной скрипт с кодом приложения.
- `requirements.txt`: Список зависимостей.
- `training.log`: Лог-файл для записи событий обучения и ошибок.
- `model_*.joblib`: Сохраненные модели (создаются после обучения).
- `report.tex`: Создается при генерации PDF.
- `*.csv`, `*.json`: Результаты сравнения моделей, анализа гиперпараметров и тестирования подвыборок.

## Датасет

Приложение ожидает датасет в формате CSV (`POLOMKA.csv`) со следующими столбцами:

| Столбец                     | Описание                                              |
|-----------------------------|-------------------------------------------------------|
| `Type`                      | Категориальная переменная (например, L, M, H)          |
| `Air temperature [K]`       | Температура воздуха в Кельвинах                       |
| `Process temperature [K]`   | Температура процесса в Кельвинах                      |
| `Rotational speed [rpm]`    | Скорость вращения в оборотах в минуту                 |
| `Torque [Nm]`               | Крутящий момент в Ньютон-метрах                       |
| `Tool wear [min]`           | Время износа инструмента в минутах                    |
| `Target`                    | Целевая переменная (0 - нет неисправности, 1 - неисправность) |
| `UDI`, `Product ID`, `Failure Type` | Опциональные столбцы (удаляются при предобработке) |

Если датасет недоступен, используйте опцию генерации синтетических данных в интерфейсе.

## Генерация PDF-отчета

1. Выберите действие *Генерация PDF-отчета* в интерфейсе.
2. Скачайте сгенерированный файл.
3. Полученный файл `report.pdf` содержит сравнение моделей, интерпретацию и рекомендации.

## Ограничения и рекомендации

- **Boruta и SHAP**: Эти модули опциональны. Установите их для использования подбора признаков и анализа SHAP-значений:
  ```
  pip install boruta shap
  ```
- **Производительность**: Подбор гиперпараметров и стресс-тестирование могут быть ресурсоемкими. Используйте мощное оборудование или ограничьте объем данных.
- **Датасет**: Убедитесь, что загружаемый датасет соответствует ожидаемой структуре. В случае ошибок проверьте логи в `training.log`.

## Автор

**Комаров Даниил Иванович**
